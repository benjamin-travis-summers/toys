#!/usr/bin/env bash

set -ex

lts=10.0
script=$1

test -n "$script"

shift 1

tmp=$(mktemp ./XXXXXX.hs)

cat >$tmp <<EOF
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE TypeApplications #-}
{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE FlexibleContexts #-}
{-# LANGUAGE LambdaCase #-}
{-# LANGUAGE NoImplicitPrelude #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# OPTIONS_GHC -fdefer-type-errors #-}
{-# OPTIONS_GHC -Wdeferred-out-of-scope-variables #-}

import qualified HaskellScript
import qualified ClassyPrelude
import qualified Control.Lens as Lens
import qualified Turtle
import qualified Prelude

--------------------------------------------------------------------------------

EOF

cat "$script" >> "$tmp"

echo $tmp
stack script --resolver=lts-$lts "$tmp" "$@"
rm $tmp
