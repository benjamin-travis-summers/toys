#!/usr/bin/env bash

set -ex

lts=9.14
script=$1

test -n "$script"

shift 1

tmp=$(mktemp ./XXXXXX.hs)

cat >$tmp <<EOF
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE TypeApplications #-}
{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE FlexibleContexts #-}
{-# LANGUAGE LambdaCase #-}
{-# LANGUAGE NoImplicitPrelude #-}
{-# LANGUAGE ScopedTypeVariables #-}

import HaskellScript

import qualified ClassyPrelude
import qualified Control.Lens as Lens
import qualified Turtle
import qualified Prelude

--------------------------------------------------------------------------------

EOF

cat "$script" >> "$tmp"

echo $tmp
stack script --resolver=lts-$lts "$tmp" "$@"
